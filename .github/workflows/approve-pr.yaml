# Approve Dependabot dependencies
#
# Approved dependencies
# ---------------------
# babel-
#   @babel/*, babel-loader (build)
#   @babel/node (check-node-versions)
#
# eslint-
#   eslint, eslint-config-*, eslint-plugin-* (lint)
#
# prettier-
#   prettier (lint)
#
# types-
#   @types/* (type-check)
#
# typescript-
#   typescript (type-check)
#
# typescript-eslint-parser-
#   @typescript-eslint/parser (lint)
#
# webpack-
#   webpack, webpack-cli (build)
#
# Other dependencies
# ------------------
# @actions/core, @octokit/rest, btoa, envalid
# diff, husky, lint-staged, node-fetch

name: Approve PR

on: pull_request

jobs:
  approve-bots-pr:
    name: "Approve bot's PR"
    runs-on: ubuntu-latest
    if: >-
      (
        (
          github.event.pull_request.user.login == 'dependabot[bot]' ||
          github.event.pull_request.user.login == 'dependabot-preview[bot]'
        ) &&
        (
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-babel-') ||
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-eslint-') ||
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-prettier-') ||
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-types-') ||
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-typescript-') ||
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-typescript-eslint-parser-') ||
          startsWith(github.head_ref, 'dependabot-npm_and_yarn-webpack-')
        )
      ) ||
      (
        github.event.pull_request.user.login == 'branoholy-bot' &&
        (
          github.head_ref == 'deps-update-lock-file' ||
          github.head_ref == 'deps-update-node' ||
          github.head_ref == 'build-update-dist'
        )
      )
    steps:
      - name: Approve pull request
        uses: hmarr/auto-approve-action@v2.0.0
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}

  approve-owners-pr:
    name: "Approve owner's PR"
    runs-on: ubuntu-latest
    if: github.event.pull_request.user.login == 'branoholy'
    steps:
      - name: Approve pull request
        uses: hmarr/auto-approve-action@v2.0.0
        with:
          github-token: ${{ secrets.BRANOHOLY_BOT_TOKEN }}
